import{bD as jt,bc as Wt,bE as ut,bF as lt,bG as dt,bH as Kt,bI as qt,bJ as ct,q as ne,x as Se,s as pt,aa as He,ab as P,bK as zt,bn as ft,bL as ht,a7 as Yt,a9 as Xt,ac as Gt,y as Jt,bM as Qt,bN as Zt,_ as K,o as b,b as y,F as Q,d as fe,f as ie,t as Z,p as re,bO as en,P as tn,h as S,a as J,j as W,w as ee,c as I,H as pe,aD as nn,aE as rn,n as on,a2 as mt,bP as sn,bQ as an,bR as un,bS as ln,bT as dn,bU as cn,bV as pn,bW as fn,bX as hn,bY as mn,bZ as vn,b_ as gn,b$ as bn,c0 as yn,c1 as wn,c2 as Tn,c3 as Cn,c4 as En,r as Ee}from"./index-683cf2d0.js";var _n="tippy-box",vt="tippy-content",xn="tippy-backdrop",gt="tippy-arrow",bt="tippy-svg-arrow",R={passive:!0,capture:!0},yt=function(){return document.body};function _e(e,t,n){if(Array.isArray(e)){var r=e[t];return r??(Array.isArray(n)?n[t]:n)}return e}function Le(e,t){var n={}.toString.call(e);return n.indexOf("[object")===0&&n.indexOf(t+"]")>-1}function wt(e,t){return typeof e=="function"?e.apply(void 0,t):e}function Qe(e,t){if(t===0)return e;var n;return function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)}}function An(e){return e.split(/\s+/).filter(Boolean)}function j(e){return[].concat(e)}function Ze(e,t){e.indexOf(t)===-1&&e.push(t)}function Mn(e){return e.filter(function(t,n){return e.indexOf(t)===n})}function On(e){return e.split("-")[0]}function he(e){return[].slice.call(e)}function et(e){return Object.keys(e).reduce(function(t,n){return e[n]!==void 0&&(t[n]=e[n]),t},{})}function te(){return document.createElement("div")}function me(e){return["Element","Fragment"].some(function(t){return Le(e,t)})}function Dn(e){return Le(e,"NodeList")}function Sn(e){return Le(e,"MouseEvent")}function Hn(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function Ln(e){return me(e)?[e]:Dn(e)?he(e):Array.isArray(e)?e:he(document.querySelectorAll(e))}function xe(e,t){e.forEach(function(n){n&&(n.style.transitionDuration=t+"ms")})}function tt(e,t){e.forEach(function(n){n&&n.setAttribute("data-state",t)})}function kn(e){var t,n=j(e),r=n[0];return r!=null&&(t=r.ownerDocument)!=null&&t.body?r.ownerDocument:document}function Bn(e,t){var n=t.clientX,r=t.clientY;return e.every(function(c){var u=c.popperRect,a=c.popperState,s=c.props,d=s.interactiveBorder,h=On(a.placement),g=a.modifiersData.offset;if(!g)return!0;var C=h==="bottom"?g.top.y:0,E=h==="top"?g.bottom.y:0,A=h==="right"?g.left.x:0,w=h==="left"?g.right.x:0,H=u.top-r+C>d,V=r-u.bottom-E>d,oe=u.left-n+A>d,L=n-u.right-w>d;return H||V||oe||L})}function Ae(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(c){e[r](c,n)})}function nt(e,t){for(var n=t;n;){var r;if(e.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var D={isTouch:!1},it=0;function Rn(){D.isTouch||(D.isTouch=!0,window.performance&&document.addEventListener("mousemove",Tt))}function Tt(){var e=performance.now();e-it<20&&(D.isTouch=!1,document.removeEventListener("mousemove",Tt)),it=e}function Pn(){var e=document.activeElement;if(Hn(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function In(){document.addEventListener("touchstart",Rn,R),window.addEventListener("blur",Pn)}var Fn=typeof window<"u"&&typeof document<"u",Vn=Fn?!!window.msCrypto:!1,Nn={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},$n={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},M=Object.assign({appendTo:yt,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Nn,$n),Un=Object.keys(M),jn=function(t){var n=Object.keys(t);n.forEach(function(r){M[r]=t[r]})};function Ct(e){var t=e.plugins||[],n=t.reduce(function(r,c){var u=c.name,a=c.defaultValue;if(u){var s;r[u]=e[u]!==void 0?e[u]:(s=M[u])!=null?s:a}return r},{});return Object.assign({},e,n)}function Wn(e,t){var n=t?Object.keys(Ct(Object.assign({},M,{plugins:t}))):Un,r=n.reduce(function(c,u){var a=(e.getAttribute("data-tippy-"+u)||"").trim();if(!a)return c;if(u==="content")c[u]=a;else try{c[u]=JSON.parse(a)}catch{c[u]=a}return c},{});return r}function rt(e,t){var n=Object.assign({},t,{content:wt(t.content,[e])},t.ignoreAttributes?{}:Wn(e,t.plugins));return n.aria=Object.assign({},M.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?t.interactive:n.aria.expanded,content:n.aria.content==="auto"?t.interactive?null:"describedby":n.aria.content},n}var Kn=function(){return"innerHTML"};function Oe(e,t){e[Kn()]=t}function ot(e){var t=te();return e===!0?t.className=gt:(t.className=bt,me(e)?t.appendChild(e):Oe(t,e)),t}function st(e,t){me(t.content)?(Oe(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?Oe(e,t.content):e.textContent=t.content)}function De(e){var t=e.firstElementChild,n=he(t.children);return{box:t,content:n.find(function(r){return r.classList.contains(vt)}),arrow:n.find(function(r){return r.classList.contains(gt)||r.classList.contains(bt)}),backdrop:n.find(function(r){return r.classList.contains(xn)})}}function Et(e){var t=te(),n=te();n.className=_n,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=te();r.className=vt,r.setAttribute("data-state","hidden"),st(r,e.props),t.appendChild(n),n.appendChild(r),c(e.props,e.props);function c(u,a){var s=De(t),d=s.box,h=s.content,g=s.arrow;a.theme?d.setAttribute("data-theme",a.theme):d.removeAttribute("data-theme"),typeof a.animation=="string"?d.setAttribute("data-animation",a.animation):d.removeAttribute("data-animation"),a.inertia?d.setAttribute("data-inertia",""):d.removeAttribute("data-inertia"),d.style.maxWidth=typeof a.maxWidth=="number"?a.maxWidth+"px":a.maxWidth,a.role?d.setAttribute("role",a.role):d.removeAttribute("role"),(u.content!==a.content||u.allowHTML!==a.allowHTML)&&st(h,e.props),a.arrow?g?u.arrow!==a.arrow&&(d.removeChild(g),d.appendChild(ot(a.arrow))):d.appendChild(ot(a.arrow)):g&&d.removeChild(g)}return{popper:t,onUpdate:c}}Et.$$tippy=!0;var qn=1,ce=[],Me=[];function zn(e,t){var n=rt(e,Object.assign({},M,Ct(et(t)))),r,c,u,a=!1,s=!1,d=!1,h=!1,g,C,E,A=[],w=Qe(We,n.interactiveDebounce),H,V=qn++,oe=null,L=Mn(n.plugins),q={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},i={id:V,reference:e,popper:te(),popperInstance:oe,props:n,state:q,plugins:L,clearDelayTimeouts:Bt,setProps:Rt,setContent:Pt,show:It,hide:Ft,hideWithInteractivity:Vt,enable:Lt,disable:kt,unmount:Nt,destroy:$t};if(!n.render)return i;var ge=n.render(i),f=ge.popper,z=ge.onUpdate;f.setAttribute("data-tippy-root",""),f.id="tippy-"+i.id,i.popper=f,e._tippy=i,f._tippy=i;var Mt=L.map(function(o){return o.fn(i)}),Ot=e.hasAttribute("aria-expanded");return $e(),G(),se(),_("onCreate",[i]),n.showOnCreate&&Ge(),f.addEventListener("mouseenter",function(){i.props.interactive&&i.state.isVisible&&i.clearDelayTimeouts()}),f.addEventListener("mouseleave",function(){i.props.interactive&&i.props.trigger.indexOf("mouseenter")>=0&&Y().addEventListener("mousemove",w)}),i;function ke(){var o=i.props.touch;return Array.isArray(o)?o:[o,0]}function Be(){return ke()[0]==="hold"}function O(){var o;return!!((o=i.props.render)!=null&&o.$$tippy)}function k(){return H||e}function Y(){var o=k().parentNode;return o?kn(o):document}function X(){return De(f)}function Re(o){return i.state.isMounted&&!i.state.isVisible||D.isTouch||g&&g.type==="focus"?0:_e(i.props.delay,o?0:1,M.delay)}function se(o){o===void 0&&(o=!1),f.style.pointerEvents=i.props.interactive&&!o?"":"none",f.style.zIndex=""+i.props.zIndex}function _(o,l,p){if(p===void 0&&(p=!0),Mt.forEach(function(m){m[o]&&m[o].apply(m,l)}),p){var v;(v=i.props)[o].apply(v,l)}}function Pe(){var o=i.props.aria;if(o.content){var l="aria-"+o.content,p=f.id,v=j(i.props.triggerTarget||e);v.forEach(function(m){var T=m.getAttribute(l);if(i.state.isVisible)m.setAttribute(l,T?T+" "+p:p);else{var x=T&&T.replace(p,"").trim();x?m.setAttribute(l,x):m.removeAttribute(l)}})}}function G(){if(!(Ot||!i.props.aria.expanded)){var o=j(i.props.triggerTarget||e);o.forEach(function(l){i.props.interactive?l.setAttribute("aria-expanded",i.state.isVisible&&l===k()?"true":"false"):l.removeAttribute("aria-expanded")})}}function be(){Y().removeEventListener("mousemove",w),ce=ce.filter(function(o){return o!==w})}function ae(o){if(!(D.isTouch&&(d||o.type==="mousedown"))){var l=o.composedPath&&o.composedPath()[0]||o.target;if(!(i.props.interactive&&nt(f,l))){if(j(i.props.triggerTarget||e).some(function(p){return nt(p,l)})){if(D.isTouch||i.state.isVisible&&i.props.trigger.indexOf("click")>=0)return}else _("onClickOutside",[i,o]);i.props.hideOnClick===!0&&(i.clearDelayTimeouts(),i.hide(),s=!0,setTimeout(function(){s=!1}),i.state.isMounted||ye())}}}function Ie(){d=!0}function Fe(){d=!1}function Ve(){var o=Y();o.addEventListener("mousedown",ae,!0),o.addEventListener("touchend",ae,R),o.addEventListener("touchstart",Fe,R),o.addEventListener("touchmove",Ie,R)}function ye(){var o=Y();o.removeEventListener("mousedown",ae,!0),o.removeEventListener("touchend",ae,R),o.removeEventListener("touchstart",Fe,R),o.removeEventListener("touchmove",Ie,R)}function Dt(o,l){Ne(o,function(){!i.state.isVisible&&f.parentNode&&f.parentNode.contains(f)&&l()})}function St(o,l){Ne(o,l)}function Ne(o,l){var p=X().box;function v(m){m.target===p&&(Ae(p,"remove",v),l())}if(o===0)return l();Ae(p,"remove",C),Ae(p,"add",v),C=v}function N(o,l,p){p===void 0&&(p=!1);var v=j(i.props.triggerTarget||e);v.forEach(function(m){m.addEventListener(o,l,p),A.push({node:m,eventType:o,handler:l,options:p})})}function $e(){Be()&&(N("touchstart",je,{passive:!0}),N("touchend",Ke,{passive:!0})),An(i.props.trigger).forEach(function(o){if(o!=="manual")switch(N(o,je),o){case"mouseenter":N("mouseleave",Ke);break;case"focus":N(Vn?"focusout":"blur",qe);break;case"focusin":N("focusout",qe);break}})}function Ue(){A.forEach(function(o){var l=o.node,p=o.eventType,v=o.handler,m=o.options;l.removeEventListener(p,v,m)}),A=[]}function je(o){var l,p=!1;if(!(!i.state.isEnabled||ze(o)||s)){var v=((l=g)==null?void 0:l.type)==="focus";g=o,H=o.currentTarget,G(),!i.state.isVisible&&Sn(o)&&ce.forEach(function(m){return m(o)}),o.type==="click"&&(i.props.trigger.indexOf("mouseenter")<0||a)&&i.props.hideOnClick!==!1&&i.state.isVisible?p=!0:Ge(o),o.type==="click"&&(a=!p),p&&!v&&ue(o)}}function We(o){var l=o.target,p=k().contains(l)||f.contains(l);if(!(o.type==="mousemove"&&p)){var v=we().concat(f).map(function(m){var T,x=m._tippy,$=(T=x.popperInstance)==null?void 0:T.state;return $?{popperRect:m.getBoundingClientRect(),popperState:$,props:n}:null}).filter(Boolean);Bn(v,o)&&(be(),ue(o))}}function Ke(o){var l=ze(o)||i.props.trigger.indexOf("click")>=0&&a;if(!l){if(i.props.interactive){i.hideWithInteractivity(o);return}ue(o)}}function qe(o){i.props.trigger.indexOf("focusin")<0&&o.target!==k()||i.props.interactive&&o.relatedTarget&&f.contains(o.relatedTarget)||ue(o)}function ze(o){return D.isTouch?Be()!==o.type.indexOf("touch")>=0:!1}function Ye(){Xe();var o=i.props,l=o.popperOptions,p=o.placement,v=o.offset,m=o.getReferenceClientRect,T=o.moveTransition,x=O()?De(f).arrow:null,$=m?{getBoundingClientRect:m,contextElement:m.contextElement||k()}:e,Je={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(le){var U=le.state;if(O()){var Ut=X(),Ce=Ut.box;["placement","reference-hidden","escaped"].forEach(function(de){de==="placement"?Ce.setAttribute("data-placement",U.placement):U.attributes.popper["data-popper-"+de]?Ce.setAttribute("data-"+de,""):Ce.removeAttribute("data-"+de)}),U.attributes.popper={}}}},B=[{name:"offset",options:{offset:v}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!T}},Je];O()&&x&&B.push({name:"arrow",options:{element:x,padding:3}}),B.push.apply(B,l?.modifiers||[]),i.popperInstance=Wt($,f,Object.assign({},l,{placement:p,onFirstUpdate:E,modifiers:B}))}function Xe(){i.popperInstance&&(i.popperInstance.destroy(),i.popperInstance=null)}function Ht(){var o=i.props.appendTo,l,p=k();i.props.interactive&&o===yt||o==="parent"?l=p.parentNode:l=wt(o,[p]),l.contains(f)||l.appendChild(f),i.state.isMounted=!0,Ye()}function we(){return he(f.querySelectorAll("[data-tippy-root]"))}function Ge(o){i.clearDelayTimeouts(),o&&_("onTrigger",[i,o]),Ve();var l=Re(!0),p=ke(),v=p[0],m=p[1];D.isTouch&&v==="hold"&&m&&(l=m),l?r=setTimeout(function(){i.show()},l):i.show()}function ue(o){if(i.clearDelayTimeouts(),_("onUntrigger",[i,o]),!i.state.isVisible){ye();return}if(!(i.props.trigger.indexOf("mouseenter")>=0&&i.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(o.type)>=0&&a)){var l=Re(!1);l?c=setTimeout(function(){i.state.isVisible&&i.hide()},l):u=requestAnimationFrame(function(){i.hide()})}}function Lt(){i.state.isEnabled=!0}function kt(){i.hide(),i.state.isEnabled=!1}function Bt(){clearTimeout(r),clearTimeout(c),cancelAnimationFrame(u)}function Rt(o){if(!i.state.isDestroyed){_("onBeforeUpdate",[i,o]),Ue();var l=i.props,p=rt(e,Object.assign({},l,et(o),{ignoreAttributes:!0}));i.props=p,$e(),l.interactiveDebounce!==p.interactiveDebounce&&(be(),w=Qe(We,p.interactiveDebounce)),l.triggerTarget&&!p.triggerTarget?j(l.triggerTarget).forEach(function(v){v.removeAttribute("aria-expanded")}):p.triggerTarget&&e.removeAttribute("aria-expanded"),G(),se(),z&&z(l,p),i.popperInstance&&(Ye(),we().forEach(function(v){requestAnimationFrame(v._tippy.popperInstance.forceUpdate)})),_("onAfterUpdate",[i,o])}}function Pt(o){i.setProps({content:o})}function It(){var o=i.state.isVisible,l=i.state.isDestroyed,p=!i.state.isEnabled,v=D.isTouch&&!i.props.touch,m=_e(i.props.duration,0,M.duration);if(!(o||l||p||v)&&!k().hasAttribute("disabled")&&(_("onShow",[i],!1),i.props.onShow(i)!==!1)){if(i.state.isVisible=!0,O()&&(f.style.visibility="visible"),se(),Ve(),i.state.isMounted||(f.style.transition="none"),O()){var T=X(),x=T.box,$=T.content;xe([x,$],0)}E=function(){var B;if(!(!i.state.isVisible||h)){if(h=!0,f.offsetHeight,f.style.transition=i.props.moveTransition,O()&&i.props.animation){var Te=X(),le=Te.box,U=Te.content;xe([le,U],m),tt([le,U],"visible")}Pe(),G(),Ze(Me,i),(B=i.popperInstance)==null||B.forceUpdate(),_("onMount",[i]),i.props.animation&&O()&&St(m,function(){i.state.isShown=!0,_("onShown",[i])})}},Ht()}}function Ft(){var o=!i.state.isVisible,l=i.state.isDestroyed,p=!i.state.isEnabled,v=_e(i.props.duration,1,M.duration);if(!(o||l||p)&&(_("onHide",[i],!1),i.props.onHide(i)!==!1)){if(i.state.isVisible=!1,i.state.isShown=!1,h=!1,a=!1,O()&&(f.style.visibility="hidden"),be(),ye(),se(!0),O()){var m=X(),T=m.box,x=m.content;i.props.animation&&(xe([T,x],v),tt([T,x],"hidden"))}Pe(),G(),i.props.animation?O()&&Dt(v,i.unmount):i.unmount()}}function Vt(o){Y().addEventListener("mousemove",w),Ze(ce,w),w(o)}function Nt(){i.state.isVisible&&i.hide(),i.state.isMounted&&(Xe(),we().forEach(function(o){o._tippy.unmount()}),f.parentNode&&f.parentNode.removeChild(f),Me=Me.filter(function(o){return o!==i}),i.state.isMounted=!1,_("onHidden",[i]))}function $t(){i.state.isDestroyed||(i.clearDelayTimeouts(),i.unmount(),Ue(),delete e._tippy,i.state.isDestroyed=!0,_("onDestroy",[i]))}}function F(e,t){t===void 0&&(t={});var n=M.plugins.concat(t.plugins||[]);In();var r=Object.assign({},t,{plugins:n}),c=Ln(e),u=c.reduce(function(a,s){var d=s&&zn(s,r);return d&&a.push(d),a},[]);return me(e)?u[0]:u}F.defaultProps=M;F.setDefaultProps=jn;F.currentInput=D;Object.assign({},jt,{effect:function(t){var n=t.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});F.setDefaultProps({render:Et});class Yn{constructor({editor:t,element:n,view:r,tippyOptions:c={},updateDelay:u=250,shouldShow:a}){this.preventHide=!1,this.shouldShow=({view:s,state:d,from:h,to:g})=>{const{doc:C,selection:E}=d,{empty:A}=E,w=!C.textBetween(h,g).length&&Kt(d.selection),H=this.element.contains(document.activeElement);return!(!(s.hasFocus()||H)||A||w||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:s})=>{var d;if(this.preventHide){this.preventHide=!1;return}s?.relatedTarget&&(!((d=this.element.parentNode)===null||d===void 0)&&d.contains(s.relatedTarget))||this.hide()},this.tippyBlurHandler=s=>{this.blurHandler({event:s})},this.handleDebouncedUpdate=(s,d)=>{const h=!d?.selection.eq(s.state.selection),g=!d?.doc.eq(s.state.doc);!h&&!g||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(s,h,g,d)},this.updateDelay))},this.updateHandler=(s,d,h,g)=>{var C,E,A;const{state:w,composing:H}=s,{selection:V}=w;if(H||!d&&!h)return;this.createTooltip();const{ranges:L}=V,q=Math.min(...L.map(f=>f.$from.pos)),i=Math.max(...L.map(f=>f.$to.pos));if(!((C=this.shouldShow)===null||C===void 0?void 0:C.call(this,{editor:this.editor,view:s,state:w,oldState:g,from:q,to:i}))){this.hide();return}(E=this.tippy)===null||E===void 0||E.setProps({getReferenceClientRect:((A=this.tippyOptions)===null||A===void 0?void 0:A.getReferenceClientRect)||(()=>{if(qt(w.selection)){let f=s.nodeDOM(q);const z=f.dataset.nodeViewWrapper?f:f.querySelector("[data-node-view-wrapper]");if(z&&(f=z.firstChild),f)return f.getBoundingClientRect()}return ct(s,q,i)})}),this.show()},this.editor=t,this.element=n,this.view=r,this.updateDelay=u,a&&(this.shouldShow=a),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=c,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=F(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){const{state:r}=t,c=r.selection.$from.pos!==r.selection.$to.pos;if(this.updateDelay>0&&c){this.handleDebouncedUpdate(t,n);return}const u=!n?.selection.eq(t.state.selection),a=!n?.doc.eq(t.state.doc);this.updateHandler(t,u,a,n)}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const _t=e=>new ut({key:typeof e.pluginKey=="string"?new lt(e.pluginKey):e.pluginKey,view:t=>new Yn({view:t,...e})});dt.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[_t({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class Xn{constructor({editor:t,element:n,view:r,tippyOptions:c={},shouldShow:u}){this.preventHide=!1,this.shouldShow=({view:a,state:s})=>{const{selection:d}=s,{$anchor:h,empty:g}=d,C=h.depth===1,E=h.parent.isTextblock&&!h.parent.type.spec.code&&!h.parent.textContent;return!(!a.hasFocus()||!g||!C||!E||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var s;if(this.preventHide){this.preventHide=!1;return}a?.relatedTarget&&(!((s=this.element.parentNode)===null||s===void 0)&&s.contains(a.relatedTarget))||this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.editor=t,this.element=n,this.view=r,u&&(this.shouldShow=u),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=c,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=F(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){var r,c,u;const{state:a}=t,{doc:s,selection:d}=a,{from:h,to:g}=d;if(n&&n.doc.eq(s)&&n.selection.eq(d))return;if(this.createTooltip(),!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:t,state:a,oldState:n}))){this.hide();return}(c=this.tippy)===null||c===void 0||c.setProps({getReferenceClientRect:((u=this.tippyOptions)===null||u===void 0?void 0:u.getReferenceClientRect)||(()=>ct(t,h,g))}),this.show()}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const xt=e=>new ut({key:typeof e.pluginKey=="string"?new lt(e.pluginKey):e.pluginKey,view:t=>new Xn({view:t,...e})});dt.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[xt({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});const Gn=ne({name:"BubbleMenu",props:{pluginKey:{type:[String,Object],default:"bubbleMenu"},editor:{type:Object,required:!0},updateDelay:{type:Number,default:void 0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const n=Se(null);return pt(()=>{const{updateDelay:r,editor:c,pluginKey:u,shouldShow:a,tippyOptions:s}=e;c.registerPlugin(_t({updateDelay:r,editor:c,element:n.value,pluginKey:u,shouldShow:a,tippyOptions:s}))}),He(()=>{const{pluginKey:r,editor:c}=e;c.unregisterPlugin(r)}),()=>{var r;return P("div",{ref:n},(r=t.default)===null||r===void 0?void 0:r.call(t))}}});function at(e){return Zt((t,n)=>({get(){return t(),e},set(r){e=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}class Jn extends zt{constructor(t={}){return super(t),this.vueRenderers=ft(new Map),this.contentComponent=null,this.reactiveState=at(this.view.state),this.reactiveExtensionStorage=at(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),ht(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,n){super.registerPlugin(t,n),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}const Qn=ne({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(e){const t=Se(),n=Yt();return Xt(()=>{const r=e.editor;r&&r.options.element&&t.value&&Gt(()=>{if(!t.value||!r.options.element.firstChild)return;const c=Jt(t.value);t.value.append(...r.options.element.childNodes),r.contentComponent=n.ctx._,r.setOptions({element:c}),r.createNodeViews()})}),He(()=>{const r=e.editor;if(!r||(r.isDestroyed||r.view.setProps({nodeViews:{}}),r.contentComponent=null,!r.options.element.firstChild))return;const c=document.createElement("div");c.append(...r.options.element.childNodes),r.setOptions({element:c})}),{rootEl:t}},render(){const e=[];return this.editor&&this.editor.vueRenderers.forEach(t=>{const n=P(Qt,{to:t.teleportElement,key:t.id},P(t.component,{ref:t.id,...t.props}));e.push(n)}),P("div",{ref:t=>{this.rootEl=t}},...e)}}),Zn=ne({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const n=Se(null);return pt(()=>{const{pluginKey:r,editor:c,tippyOptions:u,shouldShow:a}=e;c.registerPlugin(xt({pluginKey:r,editor:c,element:n.value,tippyOptions:u,shouldShow:a}))}),He(()=>{const{pluginKey:r,editor:c}=e;c.unregisterPlugin(r)}),()=>{var r;return P("div",{ref:n},(r=t.default)===null||r===void 0?void 0:r.call(t))}}});ne({name:"NodeViewContent",props:{as:{type:String,default:"div"}},render(){return P(this.as,{style:{whiteSpace:"pre-wrap"},"data-node-view-content":""})}});ne({name:"NodeViewWrapper",props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var e,t;return P(this.as,{class:this.decorationClasses,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))}});class ei{constructor(t,{props:n={},editor:r}){if(this.id=Math.floor(Math.random()*4294967295).toString(),this.editor=r,this.component=ht(t),this.teleportElement=document.createElement("div"),this.element=this.teleportElement,this.props=ft(n),this.editor.vueRenderers.set(this.id,this),this.editor.contentComponent){if(this.editor.contentComponent.update(),this.teleportElement.children.length!==1)throw Error("VueRenderer doesnâ€™t support multiple child elements.");this.element=this.teleportElement.firstElementChild}}get ref(){var t;return(t=this.editor.contentComponent)===null||t===void 0?void 0:t.refs[this.id]}updateProps(t={}){Object.entries(t).forEach(([n,r])=>{this.props[n]=r})}destroy(){this.editor.vueRenderers.delete(this.id)}}const ti={props:{items:{type:Array,required:!0},command:{type:Function,required:!0}},data(){return{selectedIndex:0}},watch:{items(){this.selectedIndex=0}},methods:{onKeyDown({event:e}){return e.key==="ArrowUp"?(this.upHandler(),!0):e.key==="ArrowDown"?(this.downHandler(),!0):e.key==="Enter"?(this.enterHandler(),!0):!1},upHandler(){this.selectedIndex=(this.selectedIndex+this.items.length-1)%this.items.length},downHandler(){this.selectedIndex=(this.selectedIndex+1)%this.items.length},enterHandler(){this.selectItem(this.selectedIndex)},selectItem(e){const t=this.items[e];t&&this.command({id:t.value,label:t.label})}}},ni={key:0,class:"min-w-40 rounded-lg border bg-white p-1 text-base shadow-lg"},ii=["onClick","onMouseover"];function ri(e,t,n,r,c,u){return b(),y("div",null,[n.items.length?(b(),y("div",ni,[(b(!0),y(Q,null,fe(n.items,(a,s)=>(b(),y("button",{class:ie([s===c.selectedIndex?"bg-gray-100":"text-gray-900","flex w-full items-center whitespace-nowrap rounded-md px-2 py-2 text-sm"]),key:s,onClick:d=>u.selectItem(s),onMouseover:d=>c.selectedIndex=s},Z(a.label),43,ii))),128))])):re("",!0)])}const oi=K(ti,[["render",ri]]);function si(e){return en.configure({HTMLAttributes:{class:"mention"},suggestion:ai(e)})}function ai(e){return{items:({query:t})=>e.filter(n=>n.label.toLowerCase().startsWith(t.toLowerCase())).slice(0,5),render:()=>{let t,n;return{onStart:r=>{t=new ei(oi,{props:r,editor:r.editor}),r.clientRect&&(n=F("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(r){t.updateProps(r),r.clientRect&&n[0].setProps({getReferenceClientRect:r.clientRect})},onKeyDown(r){return r.event.key==="Escape"?(n[0].hide(),!0):t.ref?.onKeyDown(r)},onExit(){n[0].destroy(),t.destroy()}}}}}const ui={name:"TipTapMenu",props:["buttons"],inject:["editor"],components:{Popover:tn},methods:{onButtonClick(e){e.action(this.editor)}}},li={class:"inline-flex bg-white px-1 py-1"},di={class:"inline-flex items-center gap-1"},ci={key:0,class:"h-4 w-[2px] border-l"},pi={key:1,class:"shrink-0"},fi=["onClick","set"],hi={key:1},mi={class:"rounded border bg-white p-1 shadow-md"},vi={class:"w-full"},gi=["onClick"],bi=["onClick","title"],yi={key:1,class:"inline-block h-4 min-w-[1rem] text-sm leading-4"};function wi(e,t,n,r,c,u){const a=S("Popover");return b(),y("div",li,[J("div",di,[(b(!0),y(Q,null,fe(n.buttons,s=>(b(),y(Q,{key:s.label},[s.type==="separator"?(b(),y("div",ci)):s.map?(b(),y("div",pi,[W(a,null,{target:ee(({togglePopover:d})=>[J("button",{class:"rounded px-2 py-1 text-base font-medium text-gray-800 transition-colors hover:bg-gray-100",onClick:d,set:e.activeBtn=s.find(h=>h.isActive(u.editor))||s[0]},[e.activeBtn.icon?(b(),I(pe(e.activeBtn.icon),{key:0,class:"h-4 w-4"})):(b(),y("span",hi,Z(e.activeBtn.label),1))],8,fi)]),body:ee(({close:d})=>[J("ul",mi,[(b(!0),y(Q,null,fe(s,h=>nn((b(),y("li",vi,[J("button",{class:"w-full rounded px-2 py-1 text-left text-base hover:bg-gray-50",onClick:()=>{u.onButtonClick(h),d()}},Z(h.label),9,gi)],512)),[[rn,h.isDisabled?!h.isDisabled(u.editor):!0]])),256))])]),_:2},1024)])):(b(),I(pe(s.component||"div"),on(mt({key:2},{editor:u.editor})),{default:ee(d=>[J("button",{class:ie(["flex rounded p-1 text-gray-800 transition-colors",s.isActive(u.editor)||d?.isActive?"bg-gray-100":"hover:bg-gray-100"]),onClick:h=>d?.onClick?d.onClick(s):u.onButtonClick(s),title:s.label},[s.icon?(b(),I(pe(s.icon),{key:0,class:"h-4 w-4"})):(b(),y("span",yi,Z(s.text),1))],10,bi)]),_:2},1040))],64))),128))])])}const At=K(ui,[["render",wi]]);function ve(e){return e instanceof Array?e.map(ve):typeof e=="object"?e:sn[e]}const Ti={name:"TextEditorFixedMenu",props:["buttons"],components:{Menu:At},inject:["editor"],computed:{fixedMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=[["Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"],"Paragraph","Separator","Bold","Italic","Separator","Bullet List","Numbered List","Separator","Align Left","Align Center","Align Right","FontColor","Separator","Image","Video","Link","Blockquote","Code","Horizontal Rule",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"],"Separator","Undo","Redo"],e.map(ve)}}};function Ci(e,t,n,r,c,u){const a=S("Menu");return u.fixedMenuButtons?(b(),I(a,{key:0,buttons:u.fixedMenuButtons},null,8,["buttons"])):re("",!0)}const Ei=K(Ti,[["render",Ci]]),_i={name:"TextEditorBubbleMenu",props:["buttons","options"],components:{BubbleMenu:Gn,Menu:At},inject:["editor"],computed:{bubbleMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=["Paragraph","Heading 2","Heading 3","Separator","Bold","Italic","Link","Separator","Bullet List","Numbered List","Separator","Image","Video","Blockquote","Code",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"]],e.map(ve)}}};function xi(e,t,n,r,c,u){const a=S("Menu"),s=S("BubbleMenu");return u.bubbleMenuButtons?(b(),I(s,mt({key:0,class:"bubble-menu rounded-md shadow-sm","tippy-options":{duration:100},editor:u.editor},n.options),{default:ee(()=>[W(a,{class:"rounded-md border border-gray-100 shadow-lg",buttons:u.bubbleMenuButtons},null,8,["buttons"])]),_:1},16,["editor"])):re("",!0)}const Ai=K(_i,[["render",xi]]),Mi={name:"TextEditorFloatingMenu",props:["buttons"],components:{FloatingMenu:Zn},inject:["editor"],computed:{floatingMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=["Paragraph","Heading 2","Heading 3","Bullet List","Numbered List","Blockquote","Code","Horizontal Rule"],e.map(ve)}}},Oi=["onClick","title"],Di={key:1,class:"inline-block h-4 min-w-[1rem] text-sm leading-4"};function Si(e,t,n,r,c,u){const a=S("FloatingMenu");return u.floatingMenuButtons?(b(),I(a,{key:0,"tippy-options":{duration:100},editor:u.editor,class:"flex"},{default:ee(()=>[(b(!0),y(Q,null,fe(u.floatingMenuButtons,s=>(b(),y("button",{key:s.label,class:ie(["flex rounded p-1 text-gray-800 transition-colors",s.isActive(u.editor)?"bg-gray-100":"hover:bg-gray-100"]),onClick:()=>s.action(u.editor),title:s.label},[s.icon?(b(),I(pe(s.icon),{key:0,class:"h-4 w-4"})):(b(),y("span",Di,Z(s.text),1))],10,Oi))),128))]),_:1},8,["editor"])):re("",!0)}const Hi=K(Mi,[["render",Si]]);function Li(e){return new an.Converter().makeHtml(e)}function ki(e){return e.split(`
`).filter(r=>r.startsWith("![")||r.startsWith("#")||r.startsWith("> ")||r.startsWith("*")||r.startsWith("- ")||r.startsWith("1. ")||r.startsWith("```")||r.startsWith("`")||r.startsWith("[")||r.startsWith("---")).length>0}const Bi={name:"TextEditor",inheritAttrs:!1,components:{EditorContent:Qn,TextEditorFixedMenu:Ei,TextEditorBubbleMenu:Ai,TextEditorFloatingMenu:Hi},props:{content:{type:String,default:null},placeholder:{type:[String,Function],default:""},editorClass:{type:[String,Array,Object],default:""},editable:{type:Boolean,default:!0},bubbleMenu:{type:[Boolean,Array],default:!1},bubbleMenuOptions:{type:Object,default:()=>({})},fixedMenu:{type:[Boolean,Array],default:!1},floatingMenu:{type:[Boolean,Array],default:!1},extensions:{type:Array,default:()=>[]},starterkitOptions:{type:Object,default:()=>({})},mentions:{type:Array,default:()=>[]}},emits:["change","focus","blur"],expose:["editor"],provide(){return{editor:un(()=>this.editor)}},data(){return{editor:null}},watch:{content(e){this.editor.getHTML()!==e&&this.editor.commands.setContent(e)},editable(e){this.editor.setEditable(e)},editorProps:{deep:!0,handler(e){this.editor&&this.editor.setOptions({editorProps:e})}}},mounted(){this.editor=new Jn({content:this.content||null,editorProps:this.editorProps,editable:this.editable,extensions:[ln.configure({...this.starterkitOptions}),dn.configure({resizable:!0}),cn,pn,fn,hn,mn.configure({types:["heading","paragraph"]}),vn,gn,bn.configure({multicolor:!0}),yn,wn,Tn.configure({openOnClick:!1}),Cn.configure({showOnlyWhenEditable:!1,placeholder:typeof this.placeholder=="function"?this.placeholder:()=>this.placeholder}),si(this.mentions),...this.extensions||[]],onUpdate:({editor:e})=>{this.$emit("change",e.getHTML())},onFocus:({editor:e,event:t})=>{this.$emit("focus",t)},onBlur:({editor:e,event:t})=>{this.$emit("blur",t)}})},beforeUnmount(){this.editor.destroy(),this.editor=null},computed:{editorProps(){return{attributes:{class:ie(["prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-gray-300 prose-th:border-gray-300 prose-td:relative prose-th:relative prose-th:bg-gray-100",this.editorClass])},clipboardTextParser:(e,t)=>{if(!ki(e)||!confirm("Do you want to convert markdown content to HTML before pasting?"))return;let n=document.createElement("div");return n.innerHTML=Li(e),(this.editor.view.someProp("clipboardParser")||this.editor.view.someProp("domParser")||En.fromSchema(this.editor.schema)).parseSlice(n,{preserveWhitespace:!0,context:t})}}}}};function Ri(e,t,n,r,c,u){const a=S("TextEditorBubbleMenu"),s=S("TextEditorFixedMenu"),d=S("TextEditorFloatingMenu"),h=S("editor-content");return c.editor?(b(),y("div",{key:0,class:ie(["relative w-full",e.$attrs.class])},[W(a,{buttons:n.bubbleMenu,options:n.bubbleMenuOptions},null,8,["buttons","options"]),W(s,{class:"w-full overflow-x-auto rounded-t-lg border border-gray-200",buttons:n.fixedMenu},null,8,["buttons"]),W(d,{buttons:n.floatingMenu},null,8,["buttons"]),Ee(e.$slots,"top"),Ee(e.$slots,"editor",{editor:c.editor},()=>[W(h,{editor:c.editor},null,8,["editor"])]),Ee(e.$slots,"bottom")],2)):re("",!0)}const Ii=K(Bi,[["render",Ri]]);export{Ii as T,Ei as a};
//# sourceMappingURL=TextEditor-2f395107.js.map
